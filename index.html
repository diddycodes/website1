<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snack Shop Dashboard</title>
    <style>
        /* Global Styles */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            position: relative;
            margin: 15% auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
            width: 60%;
            max-width: 500px;
        }

        .close {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 30px;
            color: #000;
            cursor: pointer;
        }

        /* Admin Panel */
        #adminPanel {
            display: none;
            background-color: #fff;
            padding: 20px;
            margin: 20px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        #adminPanel h1 {
            font-size: 24px;
            color: #333;
        }

        /* Profile Modal */
        #profileModal {
            display: none;
            background-color: rgba(0, 0, 0, 0.5);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Profile Picture Preview */
        #profilePicturePreview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-top: 20px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 9999;
        }

        .overlay .loading-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        /* Order Section */
        #orderHistory {
            margin: 20px;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .order-history-item {
            margin: 10px 0;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }

        .purchase-request {
            padding: 10px;
            margin: 10px 0;
            background-color: #f8f8f8;
            border-radius: 5px;
        }

        #triviaSection {
            margin-top: 20px;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>

    <!-- Admin Login Modal -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('adminModal')">&times;</span>
            <h2>Admin Login</h2>
            <input type="text" id="username" placeholder="Username" />
            <input type="password" id="password" placeholder="Password" />
            <button onclick="loginAdmin()">Login</button>
            <p id="adminMessage"></p>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel">
        <h1>Admin Dashboard</h1>
        <div id="totalOrders">Total Orders: 0</div>
        <div id="totalSales">Total Sales: $0.00</div>
        <div id="pendingOrders">Pending Orders: 0</div>
        <ul id="onlineAdminsList"></ul>
        <div id="buyerOrders"></div>
        <button onclick="clearAllRequests()">Clear All Orders</button>
        <button onclick="logoutAdmin()">Logout</button>
    </div>

    <!-- Order History Section -->
    <h2>Order History</h2>
    <div id="orderHistory">
        <!-- Order history items will appear here -->
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeProfileModal()">&times;</span>
            <h2>Update Profile</h2>
            <input type="text" id="newName" placeholder="New Name" />
            <input type="password" id="newPassword" placeholder="New Password" />
            <input type="file" id="newPfpInput" />
            <img id="profilePicturePreview" src="" alt="Profile Picture Preview" />
            <button onclick="updateProfile()">Update Profile</button>
        </div>
    </div>

    <!-- Trivia Section -->
    <div id="triviaSection">
        <h2>Trivia</h2>
        <p id="triviaText">Snack and Animal Facts will appear here!</p>
        <button onclick="generateTrivia()">Generate Trivia</button>
        <p id="animalFact"></p>
    </div>

    <div id="overlay" class="overlay">
        <div class="loading-text">Loading...</div>
    </div>

    <script>
        let adminProfile = {
            username: "",
            password: "",
            displayName: "Admin",
            pfp: "admin-profile.jpg"
        };

        let isAdmin = false;
        let adminOnlineKey = null;
        let totalSales = 0;

        function closeModal(id) {
            document.getElementById(id).style.display = "none";
        }

        function loginAdmin() {
            const user = document.getElementById("username").value;
            const pass = document.getElementById("password").value;
            if (user === "admin" && pass === "admin123") {
                adminProfile.username = user;
                adminProfile.password = pass;
                document.getElementById("adminModal").style.display = "none";
                showLoadingOverlay();
                setTimeout(() => {
                    isAdmin = true;
                    document.getElementById("adminPanel").style.display = "block";
                    updateAdminStats();
                    addAdminOnline();
                    hideLoadingOverlay();
                }, 3000);
            } else {
                document.getElementById("adminMessage").innerHTML = "<p style='color:red;'>❌ Incorrect credentials</p>";
            }
        }

        function showLoadingOverlay() {
            document.getElementById("overlay").style.display = "block";
        }

        function hideLoadingOverlay() {
            document.getElementById("overlay").style.display = "none";
        }

        function addAdminOnline() {
            // Simulate Firebase database (this would be connected to Firebase in a real app)
            adminOnlineKey = "adminKey123";
            console.log("Admin added to online list.");
        }

        function updateAdminStats() {
            // Simulating stats for orders, sales, and pending orders
            document.getElementById("totalOrders").textContent = `Total Orders: 100`;
            document.getElementById("totalSales").textContent = `Total Sales: $2000.00`;
            document.getElementById("pendingOrders").textContent = `Pending Orders: 5`;
        }

        function logoutAdmin() {
            isAdmin = false;
            document.getElementById("adminPanel").style.display = "none";
            document.getElementById("adminModal").style.display = "flex";
        }

        function generateTrivia() {
            const snackTrivia = [
                "Did you know that the first potato chip was made by accident in 1853?",
                "Oreo cookies were first introduced in 1912.",
                "Gushers were introduced by Betty Crocker in the 1990s.",
                "Red Bull contains taurine, a naturally occurring amino acid.",
                "Oreos are the best-selling cookies in the United States."
            ];

            const animalTrivia = [
                "A group of flamingos is called a 'flamboyance.'",
                "Elephants are the only animals that can’t jump.",
                "A lion’s roar can be heard from 5 miles away.",
                "A giraffe's neck has the same number of bones as a human neck.",
                "Cows have best friends and get stressed when they are separated."
            ];

            const randomIndex = Math.floor(Math.random() * snackTrivia.length);
            const randomAnimalIndex = Math.floor(Math.random() * animalTrivia.length);
            document.getElementById("triviaText").textContent = `${snackTrivia[randomIndex]} \n\n Animal Fact: ${animalTrivia[randomAnimalIndex]}`;
        }

        function updateProfile() {
            const newName = document.getElementById("newName").value;
            const newPassword = document.getElementById("newPassword").value;
            const newPfp = document.getElementById("newPfpInput").files[0];

            if (newName) adminProfile.displayName = newName;
            if (newPassword) adminProfile.password = newPassword;

            if (newPfp) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    adminProfile.pfp = e.target.result;
                    document.getElementById("profilePicturePreview").src = e.target.result;
                };
                reader.readAsDataURL(newPfp);
            }

            alert("Profile updated successfully!");
            closeModal('profileModal');
        }

        function closeProfileModal() {
            document.getElementById("profileModal").style.display = "none";
        }

    </script>
</body>

</html>
